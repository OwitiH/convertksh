---
import '../styles/global.css';

interface Props {
  title: string;
  description?: string;
  canonicalUrl?: string;
  structuredData?: any;
}

const { 
  title, 
  description = 'Free online currency tools and calculators for Kenya. Convert USD to KES, calculate PayPal to MPESA fees, and more.', 
  canonicalUrl = '/',
  structuredData
} = Astro.props;

// Generate canonical URL
const fullCanonicalUrl = new URL(canonicalUrl, 'https://convertksh.xyz').toString();

// Default structured data if not provided
const defaultStructuredData = {
  "@context": "https://schema.org",
  "@type": "WebSite",
  "name": "Kenyan Currency Tools Hub",
  "url": "https://convertksh.xyz",
  "potentialAction": {
    "@type": "SearchAction",
    "target": {
      "@type": "EntryPoint",
      "urlTemplate": "https://convertksh.xyz/search?q={search_term_string}"
    },
    "query-input": "required name=search_term_string"
  }
};

// Use provided structured data or fall back to default
const pageStructuredData = structuredData || defaultStructuredData;
---

<!doctype html>
<html lang="en">
  <head>
    <!-- Primary Meta Tags -->
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>{title}</title>
    <meta name="title" content={title} />
    <meta name="description" content={description} />
    <meta name="robots" content="index, follow" />
    <link rel="canonical" href={fullCanonicalUrl} />
    
    <!-- Favicon -->
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <link rel="icon" type="image/png" href="/favicon.png" />
    <link rel="manifest" href="/site.webmanifest" />
    
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website" />
    <meta property="og:url" content={fullCanonicalUrl} />
    <meta property="og:title" content={title} />
    <meta property="og:description" content={description} />
    <meta property="og:image" content="https://convertksh.xyz/images/og-image.jpg" />
    <meta property="og:site_name" content="Kenyan Currency Tools Hub" />
    <meta property="og:locale" content="en_KE" />
    
    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image" />
    <meta property="twitter:url" content={fullCanonicalUrl} />
    <meta name="twitter:title" content={title} />
    <meta name="twitter:description" content={description} />
    <meta property="twitter:image" content="https://convertksh.xyz/images/og-image.jpg" />
    <meta name="twitter:site" content="@kenyacurrencytools" />
    
    <!-- Structured Data / Schema.org -->
    <script type="application/ld+json" set:html={JSON.stringify(pageStructuredData)} />
    
    <!-- SEO Meta Tags -->
    <meta name="author" content="Kenyan Currency Tools Hub" />
    <meta name="geo.region" content="KE" />
    <meta name="geo.placename" content="Nairobi" />
    <meta name="geo.position" content="-1.2921;36.8219" />
    <meta name="ICBM" content="-1.2921, 36.8219" />
    <meta name="theme-color" content="#10b981" />
    <meta name="keywords" content="usd to kes today, paypal to mpesa calculator, bitcoin to mpesa, mpesa withdrawal charges, forex rates kenya, send money to kenya, best exchange rate kenya, kenyan currency, usd to kes, paypal to mpesa, crypto to kes, currency converter, kenya exchange rates" />
    
    <!-- PWA Related -->
    <meta name="mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="default" />
    <meta name="apple-mobile-web-app-title" content={title} />
    
    <!-- Preconnect to external domains -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link rel="preconnect" href="https://cdn.jsdelivr.net" />
    <link rel="dns-prefetch" href="https://cdn.jsdelivr.net" />
    
    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet" />
    
    <!-- Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-KPS5WNEY4T"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-KPS5WNEY4T');
    </script>
    
    <!-- Navigation Menu -->
    <div class="relative">
      <!-- Mobile menu button -->
      <div class="md:hidden flex items-center">
        <button id="mobile-menu-button" class="text-gray-300 hover:text-emerald-400 focus:outline-none" aria-label="Toggle menu">
          <svg class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />
          </svg>
        </button>
      </div>
      
      <!-- Desktop Navigation -->
      <nav class="hidden md:flex space-x-8">
        <a href="/" class="text-white hover:text-emerald-400 px-3 py-2 text-sm font-medium">Home</a>
        <a href="/usd-to-kes" class="text-gray-300 hover:text-emerald-400 px-3 py-2 text-sm font-medium">USD to KES</a>
        <a href="/paypal-to-mpesa" class="text-gray-300 hover:text-emerald-400 px-3 py-2 text-sm font-medium">PayPal to MPESA</a>
        <a href="/crypto-to-kes" class="text-gray-300 hover:text-emerald-400 px-3 py-2 text-sm font-medium">Crypto to KES</a>
        <a href="/withdrawal-fees" class="text-gray-300 hover:text-emerald-400 px-3 py-2 text-sm font-medium">Withdrawal Fees</a>
        <a href="/paybill-charges" class="text-gray-300 hover:text-emerald-400 px-3 py-2 text-sm font-medium">Paybill Charges</a>
        <a href="/bulk-mpesa-calculator" class="text-gray-300 hover:text-emerald-400 px-3 py-2 text-sm font-medium">Bulk M-PESA</a>
        <a href="/kes-ugx" class="text-gray-300 hover:text-emerald-400 px-3 py-2 text-sm font-medium">KES ↔ UGX</a>
        <a href="/kes-tzs" class="text-gray-300 hover:text-emerald-400 px-3 py-2 text-sm font-medium">KES ↔ TZS</a>
        <a href="/blog" class="text-gray-300 hover:text-emerald-400 px-3 py-2 text-sm font-medium">Blog</a>
      </nav>
      
      <!-- Mobile Navigation (hidden by default) -->
      <div id="mobile-menu" class="hidden md:hidden absolute left-0 w-48 mt-2 py-2 bg-gray-800 rounded-md shadow-lg z-10">
        <a href="/" class="block px-4 py-2 text-sm text-gray-300 hover:bg-gray-700 hover:text-emerald-400">Home</a>
        <a href="/usd-to-kes" class="block px-4 py-2 text-sm text-gray-300 hover:bg-gray-700 hover:text-emerald-400">USD to KES</a>
        <a href="/paypal-to-mpesa" class="block px-4 py-2 text-sm text-gray-300 hover:bg-gray-700 hover:text-emerald-400">PayPal to MPESA</a>
        <a href="/crypto-to-kes" class="block px-4 py-2 text-sm text-gray-300 hover:bg-gray-700 hover:text-emerald-400">Crypto to KES</a>
        <a href="/withdrawal-fees" class="block px-4 py-2 text-sm text-gray-300 hover:bg-gray-700 hover:text-emerald-400">Withdrawal Fees</a>
        <a href="/bulk-mpesa-calculator" class="block px-4 py-2 text-sm text-gray-300 hover:bg-gray-700 hover:text-emerald-400">Bulk M-PESA</a>
        <a href="/paybill-charges" class="block px-4 py-2 text-sm text-gray-300 hover:bg-gray-700 hover:text-emerald-400">Paybill Charges</a>
        <a href="/kes-ugx" class="block px-4 py-2 text-sm text-gray-300 hover:bg-gray-700 hover:text-emerald-400">KES ↔ UGX</a>
        <a href="/kes-tzs" class="block px-4 py-2 text-sm text-gray-300 hover:bg-gray-700 hover:text-emerald-400">KES ↔ TZS</a>
        <a href="/blog" class="block px-4 py-2 text-sm text-gray-300 hover:bg-gray-700 hover:text-emerald-400">Blog</a>
      </div>
    </div>
    


    <!-- Performance optimizations -->
    <link rel="preconnect" href="https://cdn.jsdelivr.net" />
    <link rel="dns-prefetch" href="https://cdn.jsdelivr.net" />
    <!-- Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-KPS5WNEY4T"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-KPS5WNEY4T');
    </script>
  </head>
  <body class="bg-gray-900 flex flex-col min-h-screen">
    <div class="flex-grow">
      <slot />
    </div>
    
    <!-- Footer -->
    <footer class="bg-gray-800 text-gray-300 py-12">
      <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <div class="grid grid-cols-1 md:grid-cols-4 gap-8">
          <!-- About Us -->
          <div>
            <h3 class="text-emerald-400 font-semibold mb-4">About Us</h3>
            <p class="text-sm text-gray-400">
              Your trusted source for currency conversion and financial tools in Kenya. We provide accurate, real-time exchange rates and calculators.
            </p>
          </div>
          
          <!-- Quick Links -->
          <div>
            <h3 class="text-emerald-400 font-semibold mb-4">Quick Links</h3>
            <ul class="space-y-2">
              <li><a href="/usd-to-kes" class="text-gray-300 hover:text-emerald-400 transition-colors">USD to KES</a></li>
              <li><a href="/crypto-to-kes" class="text-gray-300 hover:text-emerald-400 transition-colors">Crypto to KES</a></li>
              <li><a href="/paypal-to-mpesa" class="text-gray-300 hover:text-emerald-400 transition-colors">PayPal to MPESA</a></li>
              <li><a href="/withdrawal-fees" class="text-gray-300 hover:text-emerald-400 transition-colors">Withdrawal Fees</a></li>
            </ul>
          </div>
          
          <!-- Legal -->
          <div>
            <h3 class="text-emerald-400 font-semibold mb-4">Legal</h3>
            <ul class="space-y-2">
              <li><a href="/terms" class="text-gray-300 hover:text-emerald-400 transition-colors">Terms of Service</a></li>
              <li><a href="/privacy" class="text-gray-300 hover:text-emerald-400 transition-colors">Privacy Policy</a></li>
              <li><a href="/legal" class="text-gray-300 hover:text-emerald-400 transition-colors">Legal Information</a></li>
            </ul>
          </div>
          
          <!-- Contact -->
          <div>
            <h3 class="text-emerald-400 font-semibold mb-4">Contact</h3>
            <ul class="space-y-2">
              <li class="flex items-start">
                <svg class="h-5 w-5 text-emerald-400 mr-2 mt-0.5 flex-shrink-0" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z" />
                </svg>
                <a href="mailto:contact@convertksh.xyz" class="text-gray-300 hover:text-emerald-400 transition-colors">contact@convertksh.xyz</a>
              </li>
              <li class="flex items-start">
                <svg class="h-5 w-5 text-emerald-400 mr-2 mt-0.5 flex-shrink-0" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z" />
                </svg>
                <span>+254 713093388</span>
              </li>
            </ul>
          </div>
        </div>
        
        <!-- Copyright -->
        <div class="border-t border-gray-700 mt-10 pt-6 text-center text-sm text-gray-400">
          <p>© {new Date().getFullYear()} ConvertKSH. All rights reserved.</p>
          <p class="mt-1">
            Exchange rates are for informational purposes only and may vary by service provider.
          </p>
        </div>
      </div>
    </footer>
    
    <script>
      // Mobile menu functionality
      document.addEventListener('DOMContentLoaded', () => {
        const mobileMenuButton = document.getElementById('mobile-menu-button');
        const mobileMenu = document.getElementById('mobile-menu');
        
        if (mobileMenuButton && mobileMenu) {
          mobileMenuButton.addEventListener('click', (e) => {
            e.stopPropagation(); // Prevent event from bubbling to document
            mobileMenu.classList.toggle('hidden');
            
            // Toggle aria-expanded attribute for accessibility
            const isExpanded = mobileMenuButton.getAttribute('aria-expanded') === 'true' || false;
            mobileMenuButton.setAttribute('aria-expanded', !isExpanded);
            
            // Toggle SVG icon between menu and close
            const svg = mobileMenuButton.querySelector('svg');
            if (svg) {
              if (isExpanded) {
                // Show menu icon
                svg.innerHTML = '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />';
              } else {
                // Show close icon
                svg.innerHTML = '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />';
              }
            }
          });
          
          // Close menu when clicking outside
          document.addEventListener('click', (e) => {
            if (!mobileMenu.contains(e.target) && e.target !== mobileMenuButton) {
              mobileMenu.classList.add('hidden');
              mobileMenuButton.setAttribute('aria-expanded', 'false');
              const svg = mobileMenuButton.querySelector('svg');
              if (svg) {
                svg.innerHTML = '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />';
              }
            }
          });
        }
      });
    </script>
  </body>
</html>
